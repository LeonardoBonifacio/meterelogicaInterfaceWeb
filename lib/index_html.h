#ifndef INDEX_HTML_H
#define INDEX_HTML_H

const char *index_html =
"<!DOCTYPE html><html lang='pt-BR'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width,initial-scale=1.0'><title>Estação Meteorológica</title><script src='https://cdn.jsdelivr.net/npm/chart.js'></script><style>*{box-sizing:border-box;}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background-color:#2c3e50;color:#ecf0f1;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;padding:10px;}.container{background-color:#34495e;padding:25px;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.2);text-align:center;max-width:1050px;width:95%;margin:auto;}h1{color:#1abc9c;margin-bottom:20px;}.sensor-label{font-size:.9em;color:#bdc3c7;margin-bottom:5px;}.sensor-value{font-size:1.8em;font-weight:bold;color:#ecf0f1;}.layout-row{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;margin-bottom:20px;background-color:#2f4050;padding:15px;border-radius:8px;width:100%;}.chart-block,.offset-panel{background-color:rgba(15,23,42,0.8);padding:10px;border-radius:6px;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:350px;flex:1 1 300px;max-width:100%;}canvas{max-width:100%;height:250px!important;background-color:#1f2a3a;border-radius:4px;padding:5px;margin-bottom:10px;}.sensor-reading-below-chart{font-size:1.5em;font-weight:bold;color:#64ffda;margin-top:5px;padding:5px 10px;background-color:#26384a;border-radius:4px;display:flex;align-items:center;gap:5px;}.reading-label{color:#bdc3c7;font-size:1.0em;}.offset-panel h2{color:#1abc9c;font-size:1.3em;margin-bottom:10px;text-align:center;}.offset-form-group{display:flex;flex-direction:column;gap:5px;align-items:center;margin-bottom:10px;}.offset-form-group label{font-size:1.0em;color:#bdc3c7;}.offset-form-group input[type='number']{width:120px;padding:8px;border-radius:4px;border:1px solid #34495e;background-color:#1f2a3a;color:#ecf0f1;font-size:1.2em;text-align:center;}.offset-buttons-group{margin-top:15px;}.offset-buttons-group button{background-color:#38b2ac;color:white;border:none;padding:8px 15px;font-size:1.5em;font-weight:bold;border-radius:6px;cursor:pointer;transition:background-color .2s;}.offset-buttons-group button:hover{background-color:#2c8c87;}#offsetStatusMsg{font-size:1.0em;color:#a0aec0;margin-top:5px;}</style></head><body><div class='container'><h1>Estação Meteorológica</h1><div class='layout-row'><div class='offset-panel'><h2>Ajuste de Offsets</h2><div class='offset-form-group'><label for='tempOffsetInput'>Temp. Offset (°C):</label><input type='number' id='tempOffsetInput' value='0.0' step='0.1'></div><div class='offset-form-group'><label for='humidityOffsetInput'>Umid. Offset (%):</label><input type='number' id='humidityOffsetInput' value='0.0' step='0.1'></div><div class='offset-form-group'><label for='pressureOffsetInput'>Pressão Offset (Pa):</label><input type='number' id='pressureOffsetInput' value='0.0' step='0.1'></div><div class='offset-buttons-group'><button id='saveOffsetsBtn'>Salvar Offsets</button></div><p id='offsetStatusMsg'></p></div></div><div class='layout-row'><div class='chart-block'><canvas id='tempAHTChart'></canvas><div class='sensor-reading-below-chart'><span class='reading-label'>Temperatura (AHT20):</span><span id='tempAHT'>-- °C</span></div></div><div class='chart-block'><canvas id='humidityAHTChart'></canvas><div class='sensor-reading-below-chart'><span class='reading-label'>Umidade (AHT20):</span><span id='humidityAHT'>-- %</span></div></div></div><div class='layout-row'><div class='chart-block'><canvas id='tempBMPChart'></canvas><div class='sensor-reading-below-chart'><span class='reading-label'>Temperatura (BMP280):</span><span id='tempBMP'>-- °C</span></div></div><div class='chart-block'><canvas id='pressureBMPChart'></canvas><div class='sensor-reading-below-chart'><span class='reading-label'>Pressão (BMP280):</span><span id='pressureBMP'>-- kPa</span></div></div></div></div><script>const state={tempAHT:0,humidityAHT:0,tempBMP:0,pressureBMP:0,altitudeBMP:0,seaLevelPressure:0,tempAHTHistory:[],humidityAHTHistory:[],tempBMPHistory:[],pressureBMPHistory:[],labels:[],tempAHTChart:null,humidityAHTChart:null,tempBMPChart:null,pressureBMPChart:null};const MAX_HISTORY_POINTS=60;const offsetInputs={temp:document.getElementById('tempOffsetInput'),humidity:document.getElementById('humidityOffsetInput'),pressure:document.getElementById('pressureOffsetInput')};const offsetStatusMsg=document.getElementById('offsetStatusMsg');let isOffsetInputFocused=true;function createChart(canvasId,label,unit){const ctx=document.getElementById(canvasId).getContext('2d');return new Chart(ctx,{type:'line',data:{labels:state.labels,datasets:[{label:label,data:[],borderColor:'#1abc9c',backgroundColor:'rgba(26,188,156,0.2)',borderWidth:1,fill:true}]},options:{responsive:true,maintainAspectRatio:false,scales:{x:{type:'category',title:{display:true,text:'Tempo',font:{size:14}},ticks:{autoSkip:true,maxTicksLimit:10,color:'#f0f0f0',font:{size:12,weight:'bold'}},grid:{color:'rgba(189,195,199,0.1)'}},y:{beginAtZero:false,title:{display:true,text:unit,font:{size:14}},ticks:{color:'#f0f0f0',font:{size:12,weight:'bold'},callback:function(value,index,ticks){return value.toFixed(2);}},grid:{color:'rgba(189,195,199,0.1)'}}},plugins:{legend:{display:false},tooltip:{backgroundColor:'#34495e',titleColor:'#1abc9c',bodyColor:'#ecf0f1'}},animation:{duration:0}}});}function initializeCharts(){state.tempAHTChart=createChart('tempAHTChart','Temperatura AHT20','°C');state.humidityAHTChart=createChart('humidityAHTChart','Umidade AHT20','%');state.tempBMPChart=createChart('tempBMPChart','Temperatura BMP280','°C');state.pressureBMPChart=createChart('pressureBMPChart','Pressão BMP280','kPa');}async function fetchSystemState(){try{const r=await fetch('/system_state');if(!r.ok){throw new Error('Erro na rede ou no servidor');}const data=await r.json();document.getElementById('tempAHT').textContent=(data.temperatura_aht!==undefined?data.temperatura_aht.toFixed(2):'--')+' °C';document.getElementById('humidityAHT').textContent=(data.umidade_aht!==undefined?data.umidade_aht.toFixed(2):'--')+' %';document.getElementById('tempBMP').textContent=(data.temperatura_bmp!==undefined?data.temperatura_bmp.toFixed(2):'--')+' °C';const pressureKPa=data.pressao_bmp!==undefined?(data.pressao_bmp/1000).toFixed(2):'--';document.getElementById('pressureBMP').textContent=pressureKPa+' kPa';if(data.temp_offset!==undefined){offsetInputs.temp.value=data.temp_offset.toFixed(1);offsetInputs.humidity.value=data.humidity_offset.toFixed(1);offsetInputs.pressure.value=data.pressure_offset.toFixed(1);if(!isOffsetInputFocused){offsetInputs.temp.value=data.temp_offset.toFixed(1);offsetInputs.humidity.value=data.humidity_offset.toFixed(1);offsetInputs.pressure.value=data.pressure_offset.toFixed(1);}}const now=new Date();const h=String(now.getHours()).padStart(2,'0');const m=String(now.getMinutes()).padStart(2,'0');const s=String(now.getSeconds()).padStart(2,'0');const timeLabel=`${h}:${m}:${s}`;if(state.labels.length>=MAX_HISTORY_POINTS){state.labels.shift();state.tempAHTHistory.shift();state.humidityAHTHistory.shift();state.tempBMPHistory.shift();state.pressureBMPHistory.shift();}state.labels.push(timeLabel);state.tempAHTHistory.push(data.temperatura_aht);state.humidityAHTHistory.push(data.umidade_aht);state.tempBMPHistory.push(data.temperatura_bmp);state.pressureBMPHistory.push(data.pressao_bmp/1000);state.tempAHTChart.data.labels=state.labels;state.tempAHTChart.data.datasets[0].data=state.tempAHTHistory;state.tempAHTChart.update();state.humidityAHTChart.data.labels=state.labels;state.humidityAHTChart.data.datasets[0].data=state.humidityAHTHistory;state.humidityAHTChart.update();state.tempBMPChart.data.labels=state.labels;state.tempBMPChart.data.datasets[0].data=state.tempBMPHistory;state.tempBMPChart.update();state.pressureBMPChart.data.labels=state.labels;state.pressureBMPChart.data.datasets[0].data=state.pressureBMPHistory;state.pressureBMPChart.update();}catch(error){console.error('Erro ao buscar dados do sistema:',error);}}async function saveOffsets(){const tOffset=parseFloat(offsetInputs.temp.value);const hOffset=parseFloat(offsetInputs.humidity.value);const pOffset=parseFloat(offsetInputs.pressure.value);if(isNaN(tOffset)||isNaN(hOffset)||isNaN(pOffset)){offsetStatusMsg.textContent='Insira números válidos.';offsetStatusMsg.style.color='#ff6b6b';return;}try{const response=await fetch('/set_offsets',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({temp_offset:tOffset,humidity_offset:hOffset,pressure_offset:pOffset})});if(response.ok){const text=await response.text();offsetStatusMsg.textContent=text;offsetStatusMsg.style.color='#4ade80';fetchSystemState();}else{const errorText=await response.text();offsetStatusMsg.textContent=`Erro: ${response.status} - ${errorText}`;offsetStatusMsg.style.color='#ff6b6b';}}catch(error){console.error('Erro ao definir offsets:',error);offsetStatusMsg.textContent='Erro de conexão.';offsetStatusMsg.style.color='#ff6b6b';}setTimeout(()=>{offsetStatusMsg.textContent='';},5000);}document.addEventListener('DOMContentLoaded',() => {initializeCharts();fetchSystemState();setInterval(fetchSystemState,2000);Object.values(offsetInputs).forEach(input => {input.addEventListener('focus',() => {isOffsetInputFocused=true;});input.addEventListener('blur',() => {isOffsetInputFocused=false;});});document.getElementById('saveOffsetsBtn').addEventListener('click',saveOffsets);});</script></body></html>";

#endif // INDEX_HTML_H